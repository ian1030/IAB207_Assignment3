{% extends 'base.html' %}

{% import "bootstrap4/form.html" as wtf %}

{% block content %}

{% with messages = get_flashed_messages() %}
{% if messages %} <!-- check if there are any messages -->
<div class="container-fluid">
    <div class="row mt-3 mb-3">
    <div class="col-md-12">
    {% for message in messages %} <!--loop through the messages-->
        <div class="alert alert-info">{{ message }}</div> <!--display as alert-->
    {% endfor %}
    </div>
</div>
</div>
{% endif %}
{% endwith %}

<div class="container mt-5">
    <div class="row">
      <div class="col-md-6">
        <img src="{{ event.event_image }}" class="img-fluid" alt="Event Image" />
      </div>
      <div class="col-md-6">
        <h1 class="mb-3">{{ event.event_name }}</h1>
        <p>{{ event.event_description }}</p>
        <p>Date: {{ event.event_date.strftime('%d %B, %Y') }}</p>
        <p>Time: {{ event.event_time.strftime('%I:%M %p') }}</p>
        <p>Venue: {{ event.event_location }}</p>
        <p> Status: {{event.event_status}}</p>
        <div class="d-flex justify-content-between">
            {% if event.user == current_user %}
            <a href="{{ url_for('event.update', event_id=event.id) }}" class="btn btn-outline-dark btn-light mr-2">Update Event</a>
                {% if event.event_status == 'Open' %}
                <form action="{{ url_for('event.cancel', event_id=event.id) }}" method="post" style="display: inline;">
                    <button type="submit" class="btn btn-outline-dark btn-danger mr-2">Cancel Event</button>
                </form>
                {% endif %}
                {% if event.event_status == 'Cancelled' %}
                <form action="{{ url_for('event.open', event_id=event.id) }}" method="post" style="display: inline;">
                    <button type="submit" class="btn btn-outline-dark mr-2">Open Event</button>
                </form>
                {% endif %}
            {% endif %}
            {% if event.user != current_user %}
            <a href="{{ url_for('event.booking', event_id=event.id) }}" class="btn btn-outline-dark btn-light mr-2">Book Event</a>
            {% endif %}
        </div>


        </form>
      </div>
    </div>
    <hr>
    <div class="row mt-5">
      <div class="col-md-12">
          <section class="content-item" id="comments">
              <div class="container">   
                  <div class="row">
                      <div class="col-sm-8">   
                        {{wtf.render_form(commentform)}}
                          
                          <h3>{{ comments|length }} Comments</h3>
                          
                          {% for comment in comments %}
                          <div class="media">
                              <a class="pull-left" href="#"><img class="media-object" src="person.png" alt=""></a>
                              <div class="media-body">
                                  <h4 class="media-heading">{{ comment.user.name }}</h4>
                                  <p>{{ comment.comment }}</p>
                                  <ul class="list-unstyled list-inline media-detail pull-left">
                                      <li><i class="fa fa-calendar"></i>{{ comment.comment_date.strftime('%d/%m/%Y') }}</li>
                                      <li><i class="fa fa-thumbs-up"></i>{{ comment.likes }}</li>
                                  </ul>
                                  <ul class="list-unstyled list-inline media-detail pull-right">
                                      <li class=""><a href="">Like</a></li>
                                      <li class=""><a href="">Reply</a></li>
                                  </ul>
                              </div>
                          </div>
                          {% endfor %}

                      </div>
                  </div>
              </div>
              </div>
          </section>
      </div>
    </div>
  </div>

{% endblock %}
